<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
{% comment %} Este boton cuando no a sido seleccionado para lista de deseos {% endcomment %}
<button class="wishlist-btn add-to-wishlist" data-product-handle="{{ producthandle }}">
  <svg width="25" height="21" viewBox="0 0 25 21" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M18.125 0C15.9375 0 13.8751 0.882589 12.5 2.31676C11.1248 0.882589 9.0625 0 6.875 0C2.99988 0 0 2.6475 0 6.06747C0 10.2593 4.24988 13.6244 10.6873 18.8089L12.5 20.2434L14.3127 18.8089C20.7501 13.6243 25 10.2593 25 6.06747C25 2.6475 22.0001 0 18.125 0ZM13.2714 17.3575L13.0178 17.5616L12.5 17.9714L11.9822 17.5617L11.729 17.3577C8.69904 14.9179 6.08227 12.8107 4.3524 10.9266C2.6723 9.0966 1.92308 7.59801 1.92308 6.06747C1.92308 4.8621 2.42921 3.75156 3.34826 2.94051C4.26424 2.13214 5.51671 1.68695 6.875 1.68695C8.44555 1.68695 9.9982 2.32836 11.0282 3.40262L12.5 4.93754L13.9717 3.40262C15.0018 2.32836 16.5544 1.68695 18.125 1.68695C19.4834 1.68695 20.7358 2.13214 21.6518 2.94045C22.5708 3.75156 23.0769 4.86204 23.0769 6.06747C23.0769 7.59801 22.3277 9.09654 20.6477 10.9265C18.9179 12.8106 16.3013 14.9176 13.2714 17.3575Z" fill="black"/>
  </svg>
  
</button>


<script>
$(document).ready(function() {
  var wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
  var productHandle = "{{ product.handle }}";
  var wishlistButton = $('.wishlist-btn[data-product-handle="' + productHandle + '"]');

  // Función para actualizar el estado del botón
  function updateWishlistButton() {
    if (wishlist.includes(productHandle)) {
      wishlistButton.html(' <svg width="25" height="23" viewBox="0 0 25 23" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.98578 1.99512C0.714246 3.26776 0 4.99317 0 6.79217C0 8.59118 0.714246 10.3166 1.98578 11.5892L2.94122 12.5485L12.5 22.1426L22.0582 12.5485L23.0142 11.5892C24.2858 10.3166 25 8.59118 25 6.79217C25 4.99317 24.2858 3.26776 23.0142 1.99512C22.3888 1.36354 21.6444 0.862172 20.8241 0.520011C20.0037 0.17785 19.1237 0.00167847 18.2348 0.00167847C17.346 0.00167847 16.466 0.17785 15.6456 0.520011C14.8253 0.862172 14.0809 1.36354 13.4554 1.99512L12.5 2.95437L11.544 1.99512C10.9186 1.36362 10.1742 0.862323 9.35394 0.520211C8.53364 0.178099 7.65368 0.00195317 6.7649 0.00195317C5.87612 0.00195317 4.99615 0.178099 4.17585 0.520211C3.35555 0.862323 2.61119 1.36362 1.98578 1.99512Z" fill="#FF143A"/><path opacity="0.4" d="M2.79557 9.10715C2.39026 8.40513 2.17688 7.60879 2.17688 6.79816C2.17688 5.98754 2.39026 5.1912 2.79557 4.48918C3.20091 3.78699 3.78398 3.2039 4.48615 2.79854C5.18831 2.39317 5.98483 2.17981 6.79561 2.17992" stroke="white" stroke-width="1.99933" stroke-linecap="round" stroke-linejoin="round"/><path fill-rule="evenodd" clip-rule="evenodd" d="M6.76512 0.00108755C5.87633 0.000832299 4.99631 0.176786 4.17595 0.518775C3.35558 0.860763 2.61116 1.362 1.98573 1.9935C1.71762 2.26608 1.47275 2.56059 1.25366 2.87394C1.26453 2.86307 1.26453 2.86144 1.27105 2.85492C1.84193 2.27853 2.52137 1.82098 3.27012 1.50873C4.01887 1.19648 4.82207 1.03571 5.63332 1.03571C6.44457 1.03571 7.24777 1.19648 7.99652 1.50873C8.74527 1.82098 9.42471 2.27853 9.99558 2.85492L11.2847 4.15493L12.157 3.27829C12.269 3.16579 12.3869 3.06416 12.5048 2.96253L11.5456 1.99295C10.9202 1.36136 10.1758 0.860021 9.35545 0.517939C8.53508 0.175856 7.65504 -0.00018399 6.76621 1.44302e-07L6.76512 0.00108755ZM18.2342 0.00108755C16.8255 0.00108755 15.4212 0.450004 14.2315 1.33371C15.3097 0.987204 16.4628 0.945965 17.5629 1.21456C18.6631 1.48316 19.6675 2.0511 20.4647 2.85546C21.6252 4.01692 22.2771 5.59162 22.2771 7.23349C22.2771 8.87535 21.6252 10.45 20.4647 11.6115L19.5924 12.4882L11.2369 20.8752L12.4994 22.1426L22.0582 12.5474L23.0131 11.5876C24.2845 10.3148 24.9987 8.58932 24.9987 6.79028C24.9987 4.99123 24.2845 3.26576 23.0131 1.99295C22.3877 1.36152 21.6434 0.860323 20.8231 0.518336C20.0029 0.17635 19.1229 0.000360437 18.2342 0.000543847V0.00108755Z" fill="#D30045"/></svg>');
    } else {
      wishlistButton.html(' <svg width="25" height="21" viewBox="0 0 25 21" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18.125 0C15.9375 0 13.8751 0.882589 12.5 2.31676C11.1248 0.882589 9.0625 0 6.875 0C2.99988 0 0 2.6475 0 6.06747C0 10.2593 4.24988 13.6244 10.6873 18.8089L12.5 20.2434L14.3127 18.8089C20.7501 13.6243 25 10.2593 25 6.06747C25 2.6475 22.0001 0 18.125 0ZM13.2714 17.3575L13.0178 17.5616L12.5 17.9714L11.9822 17.5617L11.729 17.3577C8.69904 14.9179 6.08227 12.8107 4.3524 10.9266C2.6723 9.0966 1.92308 7.59801 1.92308 6.06747C1.92308 4.8621 2.42921 3.75156 3.34826 2.94051C4.26424 2.13214 5.51671 1.68695 6.875 1.68695C8.44555 1.68695 9.9982 2.32836 11.0282 3.40262L12.5 4.93754L13.9717 3.40262C15.0018 2.32836 16.5544 1.68695 18.125 1.68695C19.4834 1.68695 20.7358 2.13214 21.6518 2.94045C22.5708 3.75156 23.0769 4.86204 23.0769 6.06747C23.0769 7.59801 22.3277 9.09654 20.6477 10.9265C18.9179 12.8106 16.3013 14.9176 13.2714 17.3575Z" fill="black"/></svg>');
    }
  }

  // Inicializar el estado del botón
  updateWishlistButton();

  // Cambiar el estado del botón al hacer clic
  wishlistButton.on('click', function() {
    if (wishlist.includes(productHandle)) {
      wishlist = wishlist.filter(function(handle) { return handle !== productHandle; });
    } else {
      wishlist.push(productHandle);
    }

    localStorage.setItem('wishlist', JSON.stringify(wishlist));
    updateWishlistButton(); // Actualizar el botón
    updateWishlistCount(); // Actualizar el contador
  });
});

function updateWishlistCount() {
  var wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
  $('.wishlist-count').text(wishlist.length);
}
</script>
